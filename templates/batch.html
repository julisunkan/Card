{% extends "base.html" %}

{% block title %}Batch Generator - Business Card Generator{% endblock %}

{% block content %}
<div class="row">
    <div class="col-lg-8">
        <div class="card">
            <div class="card-header">
                <h2 class="card-title mb-0">
                    <i class="fas fa-layer-group me-2"></i>Batch Business Card Generator
                </h2>
            </div>
            <div class="card-body">
                <div class="alert alert-info">
                    <i class="fas fa-info-circle me-2"></i>
                    Upload a CSV file with contact information to generate multiple business cards at once. 
                    All cards will be packaged in a ZIP file for download.
                </div>
                
                <form method="POST" action="{{ url_for('batch_upload') }}" enctype="multipart/form-data">
                    <div class="row">
                        <div class="col-md-6">
                            <h5 class="mb-3">CSV File Upload</h5>
                            
                            <div class="mb-3">
                                <label for="csv_file" class="form-label">CSV File *</label>
                                <input type="file" class="form-control" id="csv_file" name="csv_file" accept=".csv" required>
                                <div class="form-text">
                                    Upload a CSV file with columns: name, job_title, company, email, phone, website, address, linkedin, twitter, instagram, github
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <h5 class="mb-3">Batch Settings</h5>
                            
                            <div class="mb-3">
                                <label for="batch_template" class="form-label">Template</label>
                                <select class="form-select" id="batch_template" name="batch_template">
                                    <option value="modern">Modern</option>
                                    <option value="classic">Classic</option>
                                    <option value="creative">Creative</option>
                                    <option value="elegant">Elegant</option>
                                    <option value="tech">Tech</option>
                                    <option value="corporate">Corporate</option>
                                    <option value="artistic">Artistic</option>
                                    <option value="minimal">Minimal</option>
                                    <option value="bold">Bold</option>
                                    <option value="vintage">Vintage</option>
                                    <option value="geometric">Geometric</option>
                                    <option value="gradient">Gradient</option>
                                    <option value="executive">Executive</option>
                                </select>
                            </div>
                            
                            <div class="mb-3">
                                <label for="batch_color" class="form-label">Color Scheme</label>
                                <select class="form-select" id="batch_color" name="batch_color">
                                    <option value="blue">Blue</option>
                                    <option value="red">Red</option>
                                    <option value="green">Green</option>
                                    <option value="purple">Purple</option>
                                    <option value="orange">Orange</option>
                                    <option value="black">Black</option>
                                    <option value="teal">Teal</option>
                                    <option value="indigo">Indigo</option>
                                    <option value="pink">Pink</option>
                                    <option value="yellow">Yellow</option>
                                    <option value="cyan">Cyan</option>
                                    <option value="brown">Brown</option>
                                    <option value="navy">Navy</option>
                                    <option value="emerald">Emerald</option>
                                    <option value="rose">Rose</option>
                                    <option value="amber">Amber</option>
                                    <option value="violet">Violet</option>
                                    <option value="slate">Slate</option>
                                </select>
                            </div>
                            
                            <div class="mb-3">
                                <label for="batch_font" class="form-label">Font Style</label>
                                <select class="form-select" id="batch_font" name="batch_font">
                                    <option value="Arial">Arial</option>
                                    <option value="Helvetica">Helvetica</option>
                                    <option value="Times">Times New Roman</option>
                                    <option value="Georgia">Georgia</option>
                                    <option value="Verdana">Verdana</option>
                                    <option value="Calibri">Calibri</option>
                                    <option value="Trebuchet">Trebuchet MS</option>
                                    <option value="Tahoma">Tahoma</option>
                                    <option value="Impact">Impact</option>
                                    <option value="Palatino">Palatino</option>
                                    <option value="Garamond">Garamond</option>
                                    <option value="Century">Century Gothic</option>
                                </select>
                            </div>
                            
                            <div class="mb-3">
                                <label for="batch_format" class="form-label">Export Format</label>
                                <select class="form-select" id="batch_format" name="batch_format">
                                    <option value="png">PNG Images</option>
                                    <option value="pdf">PDF Documents</option>
                                    <option value="html">HTML Cards</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row mt-4">
                        <div class="col-12">
                            <button type="submit" class="btn btn-primary btn-lg">
                                <i class="fas fa-upload me-2"></i>Process Batch
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <div class="col-lg-4">
        <div class="card">
            <div class="card-header">
                <h5 class="card-title mb-0">
                    <i class="fas fa-file-csv me-2"></i>CSV Format Guide
                </h5>
            </div>
            <div class="card-body">
                <p>Your CSV file should include the following columns:</p>
                <ul class="list-unstyled">
                    <li><code>name</code> - Full name (required)</li>
                    <li><code>job_title</code> - Job title</li>
                    <li><code>company</code> - Company name</li>
                    <li><code>email</code> - Email address</li>
                    <li><code>phone</code> - Phone number</li>
                    <li><code>website</code> - Website URL</li>
                    <li><code>address</code> - Physical address</li>
                </ul>
                
                <div class="mt-3">
                    <h6>Sample CSV:</h6>
                    <div class="bg-dark p-2 rounded">
                        <code class="text-light small">
name,job_title,company,email,phone<br>
John Doe,Developer,Tech Corp,john@tech.com,555-1234<br>
Jane Smith,Designer,Creative Ltd,jane@creative.com,555-5678
                        </code>
                    </div>
                </div>
                
                <div class="mt-3">
                    <a href="data:text/csv;charset=utf-8,name,job_title,company,email,phone,website,address%0AJohn Doe,Software Developer,Tech Corp,john@techcorp.com,555-1234,https://techcorp.com,123 Main St%0AJane Smith,UX Designer,Creative Ltd,jane@creative.com,555-5678,https://creative.com,456 Oak Ave" 
                       download="sample_business_cards.csv" 
                       class="btn btn-outline-primary btn-sm">
                        <i class="fas fa-download me-1"></i>Download Sample
                    </a>
                </div>
            </div>
        </div>
        
        <div class="card mt-4">
            <div class="card-header">
                <h5 class="card-title mb-0">
                    <i class="fas fa-cogs me-2"></i>Batch Process Info
                </h5>
            </div>
            <div class="card-body">
                <ul class="list-unstyled">
                    <li class="mb-2">
                        <i class="fas fa-check text-success me-2"></i>Processes multiple contacts
                    </li>
                    <li class="mb-2">
                        <i class="fas fa-check text-success me-2"></i>Consistent styling across all cards
                    </li>
                    <li class="mb-2">
                        <i class="fas fa-check text-success me-2"></i>QR codes automatically generated
                    </li>
                    <li class="mb-2">
                        <i class="fas fa-check text-success me-2"></i>ZIP file download
                    </li>
                    <li class="mb-2">
                        <i class="fas fa-check text-success me-2"></i>Multiple export formats
                    </li>
                </ul>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script>
// File upload validation
document.getElementById('csv_file').addEventListener('change', function() {
    const file = this.files[0];
    if (file) {
        if (!file.name.toLowerCase().endsWith('.csv')) {
            alert('Please select a CSV file.');
            this.value = '';
            return;
        }
        
        if (file.size > 5 * 1024 * 1024) { // 5MB limit
            alert('File is too large. Please select a file smaller than 5MB.');
            this.value = '';
            return;
        }
    }
});

// Form submission handling
document.querySelector('form').addEventListener('submit', function() {
    const submitBtn = this.querySelector('button[type="submit"]');
    const icon = submitBtn.querySelector('i');
    const originalText = submitBtn.innerHTML;
    
    submitBtn.disabled = true;
    submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Processing...';
    
    // Re-enable button after 30 seconds (in case of error)
    setTimeout(() => {
        submitBtn.disabled = false;
        submitBtn.innerHTML = originalText;
    }, 30000);
});
</script>
{% endblock %}
